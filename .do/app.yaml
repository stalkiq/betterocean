# BetterOcean: static web shell + serverless API (Gradient AI in background).
# Set GRADIENT_AGENT_ENDPOINT and GRADIENT_AGENT_KEY on the "api" component in App Platform.
name: betterocean
region: nyc

ingress:
  rules:
    - match:
        path:
          prefix: /api
      component:
        name: api
    - match:
        path:
          prefix: /
      component:
        name: web

static_sites:
  - name: web
    environment_slug: html
    source_dir: /
    index_document: index.html
    github:
      branch: main
      deploy_on_push: true
      repo: stalkiq/betterocean

functions:
  - name: api
    source_dir: api
    github:
      branch: main
      deploy_on_push: true
      repo: stalkiq/betterocean
    routes:
      - path: /api
    envs:
      - key: GRADIENT_AGENT_ENDPOINT
        scope: RUN_AND_BUILD_TIME
        type: GENERAL
        value: "https://inference.do-ai.run/v1"
      - key: GRADIENT_AGENT_KEY
        scope: RUN_AND_BUILD_TIME
        type: SECRET
        value: "sk-do-4AWFoeMqCUXGWDFGj7wv28690WpGCcWeZTM2_HR1vViLlYBo_BLyo8apjf"
